[MySQL 8.0 参考手册](https://dev.mysql.com/doc/refman/8.0/en/) / [MySQL 服务器管理](https://dev.mysql.com/doc/refman/8.0/en/server-administration.html) / mysql 系统架构

## 5.3 mysql系统架构

`mysql`架构是系统架构 。它包含存储 MySQL 服务器运行时所需信息的表。广义的分类是， `mysql`模式包含存储数据库对象元数据的数据字典表，以及用于其他操作目的的系统表。以下讨论进一步将系统表集细分为更小的类别。

- [数据字典表](https://dev.mysql.com/doc/refman/8.0/en/system-schema.html#system-schema-data-dictionary-tables)
- [授予系统表](https://dev.mysql.com/doc/refman/8.0/en/system-schema.html#system-schema-grant-tables)
- [对象信息系统表](https://dev.mysql.com/doc/refman/8.0/en/system-schema.html#system-schema-object-tables)
- [记录系统表](https://dev.mysql.com/doc/refman/8.0/en/system-schema.html#system-schema-log-tables)
- [服务器端帮助系统表](https://dev.mysql.com/doc/refman/8.0/en/system-schema.html#system-schema-help-tables)
- [时区系统表](https://dev.mysql.com/doc/refman/8.0/en/system-schema.html#system-schema-time-zone-tables)
- [复制系统表](https://dev.mysql.com/doc/refman/8.0/en/system-schema.html#system-schema-replication-tables)
- [优化器系统表](https://dev.mysql.com/doc/refman/8.0/en/system-schema.html#system-schema-optimizer-tables)
- [杂项系统表](https://dev.mysql.com/doc/refman/8.0/en/system-schema.html#system-schema-miscellaneous-tables)

本节的其余部分列举了每个类别中的表格，并带有交叉引用以获取更多信息。`InnoDB`除非另有说明，否则 数据字典表和系统表使用 存储引擎。

`mysql`系统表和数据字典表驻留在MySQL 数据目录中`InnoDB`命名 的单个表空间文件中。`mysql.ibd`以前，这些表是在`mysql`数据库目录中的单独表空间文件中创建的。

可以为 `mysql`系统模式表空间启用静态数据加密。有关更多信息，请参阅[第 15.13 节，“InnoDB 静态数据加密”](https://dev.mysql.com/doc/refman/8.0/en/innodb-data-encryption.html)。

### 数据字典表

这些表包含数据字典，其中包含有关数据库对象的元数据。有关其他信息，请参阅 [第 14 章，*MySQL 数据字典*](https://dev.mysql.com/doc/refman/8.0/en/data-dictionary.html)。

重要的

数据字典在 MySQL 8.0 中是新的。与以前的 MySQL 版本相比，启用数据字典的服务器需要一些一般的操作差异。有关详细信息，请参阅[第 14.7 节，“数据字典使用差异”](https://dev.mysql.com/doc/refman/8.0/en/data-dictionary-usage-differences.html)。此外，对于从 MySQL 5.7 升级到 MySQL 8.0，升级过程与以前的 MySQL 版本有些不同，需要您通过检查特定的先决条件来验证安装的升级准备情况。有关更多信息，请参阅[第 2.11 节，“升级 MySQL”](https://dev.mysql.com/doc/refman/8.0/en/upgrading.html)，特别是 [第 2.11.5 节，“准备升级安装”](https://dev.mysql.com/doc/refman/8.0/en/upgrade-prerequisites.html)。

- `catalogs`: 目录信息。
- `character_sets`：有关可用字符集的信息。
- `check_constraints`：有关 `CHECK`在表上定义的约束的信息。请参阅 [第 13.1.20.6 节，“检查约束”](https://dev.mysql.com/doc/refman/8.0/en/create-table-check-constraints.html)。
- `collations`：有关每个字符集的排序规则的信息。
- `column_statistics`：列值的直方图统计。请参阅 [第 8.9.6 节，“优化器统计信息”](https://dev.mysql.com/doc/refman/8.0/en/optimizer-statistics.html)。
- `column_type_elements`：有关列使用的类型的信息。
- `columns`：有关表中列的信息。
- `dd_properties`：标识数据字典属性的表，例如其版本。服务器使用它来确定数据字典是否必须升级到较新的版本。
- `events`：有关事件调度程序事件的信息。请参阅[第 25.4 节，“使用事件调度程序”](https://dev.mysql.com/doc/refman/8.0/en/event-scheduler.html)。如果使用该 [`--skip-grant-tables`](https://dev.mysql.com/doc/refman/8.0/en/server-options.html#option_mysqld_skip-grant-tables)选项启动服务器，则禁用事件调度程序并且表中注册的事件不会运行。请参阅 [第 25.4.2 节，“事件调度程序配置”](https://dev.mysql.com/doc/refman/8.0/en/events-configuration.html)。
- `foreign_keys`, `foreign_key_column_usage`: 关于外键的信息。
- `index_column_usage`：有关索引使用的列的信息。
- `index_partitions`：有关索引使用的分区的信息。
- `index_stats`：用于存储[`ANALYZE TABLE`](https://dev.mysql.com/doc/refman/8.0/en/analyze-table.html)执行时产生的动态索引统计信息。
- `indexes`：有关表索引的信息。
- `innodb_ddl_log`：存储 DDL 日志以进行崩溃安全的 DDL 操作。
- `parameter_type_elements`：有关存储过程和函数参数的信息，以及有关存储函数的返回值的信息。
- `parameters`: 有关存储过程和函数的信息。请参阅 [第 25.2 节，“使用存储的例程”](https://dev.mysql.com/doc/refman/8.0/en/stored-routines.html)。
- `resource_groups`: 有关资源组的信息。请参阅[第 5.1.16 节，“资源组”](https://dev.mysql.com/doc/refman/8.0/en/resource-groups.html)。
- `routines`: 有关存储过程和函数的信息。请参阅 [第 25.2 节，“使用存储的例程”](https://dev.mysql.com/doc/refman/8.0/en/stored-routines.html)。
- `schemata`：关于模式的信息。在 MySQL 中，模式是数据库，因此该表提供有关数据库的信息。
- `st_spatial_reference_systems`：有关空间数据的可用空间参考系统的信息。
- `table_partition_values`：有关表分区使用的值的信息。
- `table_partitions`：有关表使用的分区的信息。
- `table_stats`：有关执行时生成的动态表统计信息[`ANALYZE TABLE`](https://dev.mysql.com/doc/refman/8.0/en/analyze-table.html)。
- `tables`：有关数据库中表的信息。
- `tablespace_files`：有关表空间使用的文件的信息。
- `tablespaces`：有关活动表空间的信息。
- `triggers`: 关于触发器的信息。
- `view_routine_usage`：关于视图之间的依赖关系和它们使用的存储函数的信息。
- `view_table_usage`：用于跟踪视图及其基础表之间的依赖关系。

数据字典表是不可见的。它们不能与 一起读取 [`SELECT`](https://dev.mysql.com/doc/refman/8.0/en/select.html)，不会出现在 的输出中[`SHOW TABLES`](https://dev.mysql.com/doc/refman/8.0/en/show-tables.html)，不在`INFORMATION_SCHEMA.TABLES` 表中列出，等等。但是，大多数情况下都有对应的`INFORMATION_SCHEMA`表可以查询。从概念上讲，它 `INFORMATION_SCHEMA`提供了一个视图，MySQL 通过该视图公开数据字典元数据。例如，您不能`mysql.schemata`直接从表中选择：

```sql
mysql> SELECT * FROM mysql.schemata;
ERROR 3554 (HY000): Access to data dictionary table 'mysql.schemata' is rejected.
```

相反，从相应的 `INFORMATION_SCHEMA`表中选择该信息：

```sql
mysql> SELECT * FROM INFORMATION_SCHEMA.SCHEMATA\G
*************************** 1. row ***************************
              CATALOG_NAME: def
               SCHEMA_NAME: mysql
DEFAULT_CHARACTER_SET_NAME: utf8mb4
    DEFAULT_COLLATION_NAME: utf8mb4_0900_ai_ci
                  SQL_PATH: NULL
        DEFAULT_ENCRYPTION: NO
*************************** 2. row ***************************
              CATALOG_NAME: def
               SCHEMA_NAME: information_schema
DEFAULT_CHARACTER_SET_NAME: utf8mb3
    DEFAULT_COLLATION_NAME: utf8mb3_general_ci
                  SQL_PATH: NULL
        DEFAULT_ENCRYPTION: NO
*************************** 3. row ***************************
              CATALOG_NAME: def
               SCHEMA_NAME: performance_schema
DEFAULT_CHARACTER_SET_NAME: utf8mb4
    DEFAULT_COLLATION_NAME: utf8mb4_0900_ai_ci
                  SQL_PATH: NULL
        DEFAULT_ENCRYPTION: NO
...
```

没有`INFORMATION_SCHEMA`与 完全对应的表`mysql.indexes`，但 [`INFORMATION_SCHEMA.STATISTICS`](https://dev.mysql.com/doc/refman/8.0/en/information-schema-statistics-table.html) 包含许多相同的信息。

到目前为止，还没有与 ,`INFORMATION_SCHEMA` 完全对应 `mysql.foreign_keys`的 表格`mysql.foreign_key_column_usage`。获取外键信息的标准SQL方式是使用 `INFORMATION_SCHEMA` [`REFERENTIAL_CONSTRAINTS`](https://dev.mysql.com/doc/refman/8.0/en/information-schema-referential-constraints-table.html)and [`KEY_COLUMN_USAGE`](https://dev.mysql.com/doc/refman/8.0/en/information-schema-key-column-usage-table.html)表；这些表现在实现为 `foreign_keys`、 `foreign_key_column_usage`和其他数据字典表的视图。

MySQL 8.0 之前的一些系统表已被数据字典表替换，并且不再存在于`mysql`系统模式中：

- `events`数据字典表取代了MySQL 8.0 之前 的`event`表。
- `parameters`和 `routines`数据字典表一起取代了MySQL 8.0 之前 的`proc`表。

### 授予系统表

这些系统表包含有关用户帐户及其所拥有权限的授权信息。有关这些表的结构、内容和用途的更多信息，请参阅[第 6.2.3 节，“授权表”](https://dev.mysql.com/doc/refman/8.0/en/grant-tables.html)。

从 MySQL 8.0 开始，授权表是`InnoDB` （事务）表。以前，这些是 `MyISAM`（非事务性）表。授予表存储引擎的变化是 MySQL 8.0 中伴随帐户管理语句行为变化的基础，例如[`CREATE USER`](https://dev.mysql.com/doc/refman/8.0/en/create-user.html)和 [`GRANT`](https://dev.mysql.com/doc/refman/8.0/en/grant.html). 以前，命名多个用户的帐户管理语句可能对某些用户成功而对其他用户失败。这些语句现在是事务性的，或者对所有命名用户都成功，或者回滚并且如果发生任何错误则无效。

笔记

如果 MySQL 从旧版本升级但授权表尚未升级`MyISAM` 到`InnoDB`，则服务器认为它们是只读的，并且帐户管理语句会产生错误。有关升级说明，请参阅[第 2.11 节，“升级 MySQL”](https://dev.mysql.com/doc/refman/8.0/en/upgrading.html)。

- `user`：用户帐户、全局权限和其他非权限列。

- `global_grants`：为用户分配动态全局权限；请参阅 [静态与动态特权](https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#static-dynamic-privileges)。

- `db`: 数据库级权限。

- `tables_priv`：表级权限。

- `columns_priv`：列级权限。

- `procs_priv`: 存储过程和函数权限。

- `proxies_priv`: 代理用户权限。

- `default_roles`：此表列出了用户连接并验证或执行后要激活的默认角色 [`SET ROLE DEFAULT`](https://dev.mysql.com/doc/refman/8.0/en/set-role.html)。

- `role_edges`：此表列出了角色子图的边。

  给定的`user`表行可能引用用户帐户或角色。`role_edges`服务器可以通过查询表中有关身份验证 ID 之间关系的信息 来区分一行是否代表用户帐户、角色或两者。

- `password_history`：有关密码更改的信息。

### 对象信息系统表

这些系统表包含有关组件、可加载函数和服务器端插件的信息：

- `component`: 使用 . 安装的服务器组件的注册表[`INSTALL COMPONENT`](https://dev.mysql.com/doc/refman/8.0/en/install-component.html)。此表中列出的任何组件都由加载程序服务在服务器启动序列期间安装。请参阅[第 5.5.1 节，“安装和卸载组件”](https://dev.mysql.com/doc/refman/8.0/en/component-loading.html)。

- `func`: 使用 . 安装的可加载功能的注册表 [`CREATE FUNCTION`](https://dev.mysql.com/doc/refman/8.0/en/create-function-loadable.html)。在正常启动序列期间，服务器会加载此表中注册的函数。如果使用该 [`--skip-grant-tables`](https://dev.mysql.com/doc/refman/8.0/en/server-options.html#option_mysqld_skip-grant-tables)选项启动服务器，则表中注册的功能不会加载并且不可用。请参阅[第 5.7.1 节，“安装和卸载可加载函数”](https://dev.mysql.com/doc/refman/8.0/en/function-loading.html)。

  笔记

  与`mysql.func`system 表一样，Performance Schema [`user_defined_functions`](https://dev.mysql.com/doc/refman/8.0/en/performance-schema-user-defined-functions-table.html)表列出了使用 [`CREATE FUNCTION`](https://dev.mysql.com/doc/refman/8.0/en/create-function-loadable.html). 与该 `mysql.func`表不同，该 [`user_defined_functions`](https://dev.mysql.com/doc/refman/8.0/en/performance-schema-user-defined-functions-table.html)表还列出了由服务器组件或插件自动安装的功能。这种差异 [`user_defined_functions`](https://dev.mysql.com/doc/refman/8.0/en/performance-schema-user-defined-functions-table.html) 更`mysql.func`适合检查安装了哪些功能。请参阅 [第 27.12.21.9 节，“user_defined_functions 表”](https://dev.mysql.com/doc/refman/8.0/en/performance-schema-user-defined-functions-table.html)。

- `plugin`：使用 . 安装的服务器端插件的注册表[`INSTALL PLUGIN`](https://dev.mysql.com/doc/refman/8.0/en/install-plugin.html)。在正常启动过程中，服务器会加载在此表中注册的插件。如果使用该 [`--skip-grant-tables`](https://dev.mysql.com/doc/refman/8.0/en/server-options.html#option_mysqld_skip-grant-tables)选项启动服务器，则表中注册的插件不会加载且不可用。请参阅[第 5.6.1 节，“安装和卸载插件”](https://dev.mysql.com/doc/refman/8.0/en/plugin-loading.html)。

  

### 记录系统表

服务器使用这些系统表进行日志记录：

- `general_log`：一般查询日志表。
- `slow_log`：慢查询日志表。

日志表使用`CSV`存储引擎。

有关更多信息，请参阅[第 5.4 节，“MySQL 服务器日志”](https://dev.mysql.com/doc/refman/8.0/en/server-logs.html)。

### 服务器端帮助系统表



这些系统表包含服务器端帮助信息：

- `help_category`：有关帮助类别的信息。
- `help_keyword`：与帮助主题相关的关键字。
- `help_relation`：帮助关键字和主题之间的映射。
- `help_topic`: 帮助主题内容。

有关详细信息，请参阅 [第 5.1.17 节，“服务器端帮助支持”](https://dev.mysql.com/doc/refman/8.0/en/server-side-help-support.html)。

### 时区系统表



这些系统表包含时区信息：

- `time_zone`: 时区 ID 以及它们是否使用闰秒。
- `time_zone_leap_second`: 当闰秒发生时。
- `time_zone_name`: 时区 ID 和名称之间的映射。
- `time_zone_transition`, `time_zone_transition_type`: 时区说明。

有关更多信息，请参阅[第 5.1.15 节，“MySQL 服务器时区支持”](https://dev.mysql.com/doc/refman/8.0/en/time-zone-support.html)。

### 复制系统表

服务器使用这些系统表来支持复制：

- `gtid_executed`：用于存储 GTID 值的表。请参阅 [mysql.gtid_executed 表](https://dev.mysql.com/doc/refman/8.0/en/replication-gtids-concepts.html#replication-gtids-gtid-executed-table)。
- `ndb_binlog_index`：NDB Cluster 复制的二进制日志信息。仅当服务器构建 [`NDBCLUSTER`](https://dev.mysql.com/doc/refman/8.0/en/mysql-cluster.html)支持时才会创建此表。请参阅 [第 23.7.4 节，“NDB 集群复制模式和表”](https://dev.mysql.com/doc/refman/8.0/en/mysql-cluster-replication-schema.html)。
- `slave_master_info`, `slave_relay_log_info`, `slave_worker_info`: 用于在副本服务器上存储复制信息。请参阅 [第 17.2.4 节，“中继日志和复制元数据存储库”](https://dev.mysql.com/doc/refman/8.0/en/replica-logs.html)。

刚刚列出的所有表都使用 [`InnoDB`](https://dev.mysql.com/doc/refman/8.0/en/innodb-storage-engine.html)存储引擎。

### 优化器系统表

这些系统表供优化器使用：

- `innodb_index_stats`, `innodb_table_stats`: 用于 `InnoDB`持久优化器统计。请参阅[第 15.8.10.1 节，“配置持久优化器统计参数”](https://dev.mysql.com/doc/refman/8.0/en/innodb-persistent-stats.html)。
- `server_cost`, `engine_cost`: 优化器成本模型使用的表包含有关在查询执行期间发生的操作的成本估计信息。 `server_cost`包含一般服务器操作的优化器成本估算。 `engine_cost`包含特定于特定存储引擎的操作的估计。请参阅 [第 8.9.5 节，“优化器成本模型”](https://dev.mysql.com/doc/refman/8.0/en/cost-model.html)。

### 杂项系统表

其他系统表不符合上述类别：

- `audit_log_filter`, `audit_log_user`: 如果安装了 MySQL Enterprise Audit，这些表提供审计日志过滤器定义和用户帐户的持久存储。请参阅 [审核日志表](https://dev.mysql.com/doc/refman/8.0/en/audit-log-reference.html#audit-log-tables)。
- `firewall_group_allowlist`, `firewall_groups`, `firewall_memebership`, `firewall_users`, `firewall_whitelist`: 如果安装了 MySQL Enterprise Firewall，这些表为防火墙使用的信息提供持久存储。请参阅 [第 6.4.7 节，“MySQL 企业防火墙”](https://dev.mysql.com/doc/refman/8.0/en/firewall.html)。
- `servers`: 由 `FEDERATED`存储引擎使用。请参阅 [第 16.8.2.2 节，“使用 CREATE SERVER 创建 FEDERATED 表”](https://dev.mysql.com/doc/refman/8.0/en/federated-create-server.html)。
- `innodb_dynamic_metadata`：由 `InnoDB`存储引擎用于存储快速变化的表元数据，例如自动增量计数器值和索引树损坏标志。替换驻留在 `InnoDB`系统表空间中的数据字典缓冲区表。